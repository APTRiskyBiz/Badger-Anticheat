    BlacklistedEvents = {
        'esx_drugs:startHarvestCoke',
        'esx_drugs:stoopHarvestCoke',
        'esx_drugs:startTransformCoke',
        'esx_drugs:stopTransformCoke',
        'esx_drugs:startSellCoke',
        'esx_drugs:stopSellCoke',
        'esx_drugs:startHarvestMeth',
        'esx_drugs:stoopHarvestMeth',
        'esx_drugs:startTransformMeth',
        'esx_drugs:stopTransformMeth',
        'esx_drugs:startSellMeth',
        'esx_drugs:stopSellMeth',
        'esx_drugs:startHarvestWeed',
        'esx_drugs:stoopHarvestWeed',
        'esx_drugs:startTransformWeed',
        'esx_drugs:stopTransformWeed',
        'esx_drugs:startSellWeed',
        'esx_drugs:stopSellWeed',
        'esx_drugs:startHarvestOpium',
        'esx_drugs:stopHarvestOpium',
        'esx_drugs:startTransformOpium',
        'esx_drugs:stopTransformOpium',
        'esx_drugs:startSellOpium',
        'esx_drugs:stopSellOpium',
        "gcPhone:_internalAddMessageLRAC",
        "gcPhone:tchat_channelLRAC",
        "esx_vehicleshop:setVehicleOwnedLRAC",
        "esx_mafiajob:confiscateLRACPlayerItem",
        "_chat:messageEntLRACered",
        "lscustoms:pLRACayGarage",
        "vrp_slotmachLRACine:server:2",
        "Banca:dLRACeposit",
        "bank:depLRACositt",
        "esx_jobs:caLRACution", "give_back",
        "esx_fueldLRACelivery:pay",
        "esx_carthLRACief:pay",
        "esx_godiLRACrtyjob:pay",
        "esx_pizza:pLRACay",
        "esx_ranger:pLRACay",
        "esx_garbageLRACjob:pay",
        "esx_truckLRACerjob:pay",
        "AdminMeLRACnu:giveBank",
        "AdminMLRACenu:giveCash",
        "esx_goLRACpostaljob:pay",
        "esx_baLRACnksecurity:pay",
        "esx_sloLRACtmachine:sv:2",
        "esx:giLRACveInventoryItem",
        "NB:recLRACruterplayer",
        "esx_biLRAClling:sendBill",
        "esx_jailer:sendToJail",
        "esx_jaLRACil:sendToJail",
        "js:jaLRACiluser",
        "esx-qalle-jail:jailyer",
        "esx_dmvschool:pLRACay", 
        "LegacyFuel:PayFuLRACel",
        "OG_cuffs:cuffCheckNeLRACarest",
        "esx_policejob:handcuff",
        "cuffSeLRACrver",
        "cuffGLRACranted",
        "police:cuffGLRACranted",
        "esx_handcuffs:cufLRACfing",
        "esx_policejob:haLRACndcuff",
        "bank:withdLRACraw",
        "dmv:succeLRACss",
        "esx_skin:responseSaLRACveSkin",
        "esx_dmvschool:addLiceLRACnse",
        "esx_mechanicjob:starLRACtCraft",
        "esx_drugs:startHarvestWLRACeed",
        "esx_drugs:startTransfoLRACrmWeed",
        "esx_drugs:startSellWeLRACed",
        "esx_drugs:startHarvestLRACCoke",
        "esx_drugs:startTransLRACformCoke",
        "esx_drugs:startSellCLRACoke",
        "esx_drugs:startHarLRACvestMeth",
        "esx_drugs:startTLRACransformMeth",
        "esx_drugs:startSellMLRACeth",
        "esx_drugs:startHLRACarvestOpium",
        "esx_drugs:startSellLRACOpium",
        "esx_drugs:starLRACtTransformOpium",
        "esx_blanchisLRACseur:startWhitening",
        "esx_drugs:stopHarvLRACestCoke",
        "esx_drugs:stopTranLRACsformCoke",
        "esx_drugs:stopSellLRACCoke",
        "esx_drugs:stopHarvesLRACtMeth",
        "esx_drugs:stopTranLRACsformMeth",
        "esx_drugs:stopSellMLRACeth",
        "esx_drugs:stopHarLRACvestWeed",
        "esx_drugs:stopTLRACransformWeed",
        "esx_drugs:stopSellWLRACeed",
        "esx_drugs:stopHarvestLRACOpium",
        "esx_drugs:stopTransLRACformOpium",
        "esx_drugs:stopSellOpiuLRACm",
        "esx_society:openBosLRACsMenu",
        "esx_jobs:caLRACution",
        "esx_tankerjob:LRACpay",
        "esx_vehicletrunk:givLRACeDirty",
        "gambling:speLRACnd",
        "AdminMenu:giveDirtyMLRAConey",
        "esx_moneywash:depoLRACsit",
        "esx_moneywash:witLRAChdraw",
        "mission:completLRACed",
        "truckerJob:succeLRACss",
        "99kr-burglary:addMLRAConey",
        "esx_jailer:unjailTiLRACme",
        "esx_ambulancejob:reLRACvive",
        "DiscordBot:plaLRACyerDied",
        "hentailover:xdlol",
        "antiLRAC8:anticheat",
        "antiLRACr6:detection",
        "esx:getShLRACaredObjLRACect",
        "esx_society:getOnlLRACinePlayers",
        "antiLRAC8r4a:anticheat",
        "antiLRACr4:detect",
        "js:jaLRACiluser", 
        "ynx8:anticheat",
        "LRAC8:anticheat",
        "adminmenu:allowall",
        "ljail:jailplayer",
        "adminmenu:setsalary",
        "adminmenu:cashoutall",
        "bank:tranLRACsfer",
        "paycheck:bonLRACus",
        "paycheck:salLRACary",
        "HCheat:TempDisableDetLRACection",
        "esx_drugs:pickedUpCLRACannabis",
        "esx_drugs:processCLRACannabis",
        "esx-qalle-hunting:LRACreward",
        "esx-qalle-hunting:seLRACll",
        "esx_mecanojob:onNPCJobCLRACompleted",
        "BsCuff:Cuff696LRAC999",
        "veh_SR:CheckMonLRACeyForVeh",
        "esx_carthief:alertcoLRACps",
        "mellotrainer:adminTeLRACmpBan",
        "mellotrainer:adminKickLRAC",
        "esx_society:putVehicleLRACInGarage",
        "antilynx8:anticheat",
        "mellotrainer:adminKick",
        "Tem2LPs5Para5dCyjuHm87y2catFkMpV",
        "dqd36JWLRC72k8FDttZ5adUKwvwq9n9m",
        "antilynx8:anticheat",
        "antilynxr4:detect",
        "antilynxr6:detection",
        "ynx8:anticheat",
        "antilynx8r4a:anticheat",
        "lynx8:anticheat",
        "AntiLynxR4:kick",
        "AntiLynxR4:log",
        "h:xd"
    }




local counter = {}
RegisterServerEvent("Anticheat:NoClip")
AddEventHandler("Anticheat:NoClip", function(distance)
    if not IsPlayerAceAllowed(source, "Anticheat.Bypass") then
        local name = GetPlayerName(source)
        local id = source;
        local ids = ExtractIdentifiers(id);
        local steam = ids.steam:gsub("steam:", "");
        local steamDec = tostring(tonumber(steam,16));
        if counter[ids.steam] ~= nil then 
            counter[ids.steam] = counter[ids.steam] + 1;
        else 
            counter[ids.steam] = 1;
        end
        if counter[ids.steam] ~= nil and counter[ids.steam] >= Config.NoClipTriggerCount then 
            steam = "https://steamcommunity.com/profiles/" .. steamDec;
            local gameLicense = ids.license;
            local discord = ids.discord;
            sendToDisc("CONFIRMED HACKER [Noclipping around]: _[" .. tostring(id) .. "] " .. GetPlayerName(id) .. "_", 
                'Steam: **' .. steam .. '**\n' ..
                'GameLicense: **' .. gameLicense .. '**\n' ..
                'Discord Tag: **<@' .. discord:gsub('discord:', '') .. '>**\n' ..
                'Discord UID: **' .. discord:gsub('discord:', '') .. '**\n');
            DropPlayer(id, "[MODDER CAUGHT]: Why you no-clipping and not staff? Stoopid ass hoe")
        end 
        Wait(6000);
        counter[ids.steam] = counter[ids.steam] - 1;
    end
end)

-- Props to Lance Good for this code (most of it at least): [https://github.com/DevLanceGood]
function IsLegal(entity) 
    local model = GetEntityModel(entity)
    if (model ~= nil) then
        if (GetEntityType(entity) == 1 and GetEntityPopulationType(entity) == 7) then 
			local towTruckDrivers = Config.TowTruckDrivers;
			local isTowTruckDriver = false;
			for i = 1, #towTruckDrivers do 
				if GetHashKey(towTruckDrivers[i]) == model then 
					isTowTruckDriver = true;
				end 
			end 
			if not isTowTruckDriver then 
				return "Spawning Peds";
			else
				return false;
			end 
        end
        for i=1, #Config.BlacklistedModels do 
            local hashkey = tonumber(Config.BlacklistedModels[i]) ~= nil and tonumber(Config.BlacklistedModels[i]) or GetHashKey(Config.BlacklistedModels[i]) 
            if (hashkey == model) then
                if (GetEntityPopulationType(entity) ~= 7) then
                    return Config.BlacklistedModels[i];
                else
                    return false 
                end
            end
        end
    end
    return false
end
-- End props 

RegisterNetEvent("Anticheat:SpectateTrigger")
AddEventHandler("Anticheat:SpectateTrigger", function(reason)
    if not IsPlayerAceAllowed(source, "Anticheat.Bypass") then 
        local id = source;
        local ids = ExtractIdentifiers(id);
        local steam = ids.steam:gsub("steam:", "");
        local steamDec = tostring(tonumber(steam,16));
        steam = "https://steamcommunity.com/profiles/" .. steamDec;
        local gameLicense = ids.license;
        local discord = ids.discord;
        sendToDisc("CONFIRMED HACKER [Tried spectating a player]: _[" .. tostring(id) .. "] " .. GetPlayerName(id) .. "_", 
            'Steam: **' .. steam .. '**\n' ..
            'GameLicense: **' .. gameLicense .. '**\n' ..
            'Discord Tag: **<@' .. discord:gsub('discord:', '') .. '>**\n' ..
            'Discord UID: **' .. discord:gsub('discord:', '') .. '**\n');
        DropPlayer(id, reason)
    end 
end)  
AddEventHandler('chatMessage', function(source, name, msg)
    local id = source;
    local ids = ExtractIdentifiers(id);
    local ip = ids.ip;
    local steam = ids.steam:gsub("steam:", "");
    local steamDec = tostring(tonumber(steam,16));
    steam = "https://steamcommunity.com/profiles/" .. steamDec;
    local gameLicense = ids.license;
    local discord = ids.discord;
    local realName = GetPlayerName(source);
    if (name ~= realName) then 
        sendToDisc("CONFIRMED HACKER [Fake Chat Message]: _[" .. tostring(id) .. "] " .. GetPlayerName(id) .. "_", 
            'Steam: **' .. steam .. '**\n' ..
            'GameLicense: **' .. gameLicense .. '**\n' ..
            'Discord Tag: **<@' .. discord:gsub('discord:', '') .. '>**\n' ..
            'Discord UID: **' .. discord:gsub('discord:', '') .. '**\n');
        DropPlayer(id, "[MODDER CAUGHT]: Why you tryna be someone else? Stoopid ass hoe")
    end
end)

function GetEntityOwner(entity)
    if (not DoesEntityExist(entity)) then 
        return nil 
    end
    local owner = NetworkGetEntityOwner(entity)
    if (GetEntityPopulationType(entity) ~= 7) then return nil end
    return owner
end

AddEventHandler('explosionEvent', function(sender, ev)
    local sender = tonumber(sender)
    CancelEvent()
    if (sender ~= nil and sender > 0) then 
        CancelEvent()
    end
end)


for i=1, #BlacklistedEvents, 1 do
  RegisterServerEvent(BlacklistedEvents[i])
    AddEventHandler(BlacklistedEvents[i], function()
        local id = source;
        local ids = ExtractIdentifiers(id);
        local steam = ids.steam:gsub("steam:", "");
        local steamDec = tostring(tonumber(steam,16));
        steam = "https://steamcommunity.com/profiles/" .. steamDec;
        local gameLicense = ids.license;
        local discord = ids.discord;
        sendToDisc("CONFIRMED HACKER [Tried executing ".. BlacklistedEvents .."]: _[" .. tostring(id) .. "] " .. GetPlayerName(id) .. "_", 
            'Steam: **' .. steam .. '**\n' ..
            'GameLicense: **' .. gameLicense .. '**\n' ..
            'Discord Tag: **<@' .. discord:gsub('discord:', '') .. '>**\n' ..
            'Discord UID: **' .. discord:gsub('discord:', '') .. '**\n');
      DropPlayer(id, "Lua execution: "..BlacklistedEvents[i],true)
    end)
end

AddEventHandler("entityCreating",  function(entity)
    local owner = GetEntityOwner(entity)
    local cancelled = false
    local model = IsLegal(entity);
    if (model) then 
        if (owner ~= nil and owner > 0) then
            local id = owner;
            local ids = ExtractIdentifiers(id);
            local steam = ids.steam:gsub("steam:", "");
            local steamDec = tostring(tonumber(steam,16));
            steam = "https://steamcommunity.com/profiles/" .. steamDec;
            local gameLicense = ids.license;
            local discord = ids.discord;
            sendToDisc("HACKER (Probably) [via Blacklisted Entity]: _[" .. tostring(id) .. "] " .. GetPlayerName(id) .. "_ has spawned something...", 
                'Steam: **' .. steam .. '**\n' ..
                'GameLicense: **' .. gameLicense .. '**\n' ..
                'Discord Tag: **<@' .. discord:gsub('discord:', '') .. '>**\n' ..
                'Discord UID: **' .. discord:gsub('discord:', '') .. '**\n'
                .. 'Blacklisted Item: **' .. tostring(model) .. "**");
            KickPlayer(owner, "Possible Hacker (Blacklisted Item: " .. tostring(model) .. ")")
        end
        CancelEvent()
        cancelled = true
    end
end)
function ExtractIdentifiers(src)
    local identifiers = {
        steam = "",
        ip = "",
        discord = "",
        license = "",
        xbl = "",
        live = ""
    }

    --Loop over all identifiers
    for i = 0, GetNumPlayerIdentifiers(src) - 1 do
        local id = GetPlayerIdentifier(src, i)

        --Convert it to a nice table.
        if string.find(id, "steam") then
            identifiers.steam = id
        elseif string.find(id, "ip") then
            identifiers.ip = id
        elseif string.find(id, "discord") then
            identifiers.discord = id
        elseif string.find(id, "license") then
            identifiers.license = id
        elseif string.find(id, "xbl") then
            identifiers.xbl = id
        elseif string.find(id, "live") then
            identifiers.live = id
        end
    end

    return identifiers
end
webhookURL = Config.Webhook;
function sendToDisc(title, message, footer)
    local embed = {}
    embed = {
        {
            ["color"] = 16711680, -- GREEN = 65280 --- RED = 16711680
            ["title"] = "**".. title .."**",
            ["description"] = "" .. message ..  "",
            ["footer"] = {
                ["text"] = footer,
            },
        }
    }
    -- Start
    -- TODO Input Webhook
    PerformHttpRequest(webhookURL, 
    function(err, text, headers) end, 'POST', json.encode({username = name, embeds = embed}), { ['Content-Type'] = 'application/json' })
  -- END
end
